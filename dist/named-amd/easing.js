enifed('easing', ['exports', 'exceptions', 'util'], function (exports, _exceptions, _util) {
    'use strict';

    exports.resolveEasingEquation = resolveEasingEquation;
    exports.computePercentageFromEasing = computePercentageFromEasing;

    function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

    var Coordinate = function Coordinate(x, y) {
        _classCallCheck(this, Coordinate);

        this.x = x;
        this.y = y;
    };

    exports.Coordinate = Coordinate;
    var LINEAR = [0, 0, 1, 1];
    exports.LINEAR = LINEAR;
    var EASE = [.25, .1, .25, 1];
    exports.EASE = EASE;
    var EASE_IN = [0.42, 0, 1, 1];
    exports.EASE_IN = EASE_IN;
    var EASE_OUT = [0, 0, 0.58, 1];
    exports.EASE_OUT = EASE_OUT;
    var EASE_IN_OUT = [0.42, 0, .58, 1];
    exports.EASE_IN_OUT = EASE_IN_OUT;
    var EPSILON = 1.0e-7;
    var EASING_REGEX = /cubic-bezier\(\s*([-\.\d]+)\s*,\s*([-\.\d]+)\s*,\s*([-\.\d]+)\s*,\s*([-\.\d]+)\s*\)/i;

    function resolveEasingEquation(name) {
        var coefficients;
        switch (name.toLowerCase()) {
            case 'linear':
                coefficients = LINEAR;
                break;
            case 'ease':
                coefficients = EASE;
                break;
            case 'ease-out':
                coefficients = EASE_OUT;
                break;
            case 'ease-in':
                coefficients = EASE_IN;
                break;
            case 'ease-in-out':
                coefficients = EASE_IN_OUT;
                break;
            default:
                var matches = name.match(EASING_REGEX);
                if (!matches) {
                    throw new _exceptions.BaseException('Invalid easing value provided');
                }
                coefficients = [_util.toFloat(matches[1]), _util.toFloat(matches[2]), _util.toFloat(matches[3]), _util.toFloat(matches[4])];
                break;
        }
        var curve = new Bezier(coefficients);
        return curve.solve.bind(curve);
    }

    // Mostly inspired by
    // https://code.google.com/p/chromium/codesearch#chromium/src/ui/gfx/geometry/cubic_bezier.cc

    var Bezier = (function () {
        function Bezier(_ref) {
            var p1x = _ref[0];
            var p1y = _ref[1];
            var p2x = _ref[2];
            var p2y = _ref[3];

            _classCallCheck(this, Bezier);

            this.cx_ = 3.0 * p1x;
            this.bx_ = 3.0 * (p2x - p1x) - this.cx_;
            this.ax_ = 1.0 - this.cx_ - this.bx_;
            this.cy_ = 3.0 * p1y;
            this.by_ = 3.0 * (p2y - p1y) - this.cy_;
            this.ay_ = 1.0 - this.cy_ - this.by_;
        }

        Bezier.prototype.x = function x(t) {
            return ((this.ax_ * t + this.bx_) * t + this.cx_) * t;
        };

        Bezier.prototype.y = function y(t) {
            return ((this.ay_ * t + this.by_) * t + this.cy_) * t;
        };

        Bezier.prototype.xprime = function xprime(t) {
            return (3.0 * this.ax_ * t + 2.0 * this.bx_) * t + this.cx_;
        };

        Bezier.prototype.yprime = function yprime(t) {
            return (3.0 * this.ay_ * t + 2.0 * this.by_) * t + this.cy_;
        };

        Bezier.prototype.solveTgivenX = function solveTgivenX(percentage) {
            // add assert(0 <= percentage && percentage <= 1);
            var t = percentage;
            var x, d;
            // First try a few iterations of Newton's method -- normally very fast.
            for (var i = 0; i < 8; i++) {
                x = this.x(t) - percentage;
                if (Math.abs(x) < EPSILON) return t;
                d = this.xprime(t);
                if (Math.abs(d) < EPSILON) break;
                t = t - x / d;
            }
            // Fallback to bisection.
            var t0 = 0.0;
            var t1 = 1.0;
            var t = percentage;
            while (t0 < t1) {
                x = this.x(t);
                if (Math.abs(x - percentage) < EPSILON) return t;
                if (percentage > x) t0 = t;else t1 = t;
                t = (t1 - t0) * .5 + t0;
            }
            return t;
        };

        Bezier.prototype.solve = function solve(percentage) {
            return this.y(this.solveTgivenX(percentage));
        };

        return Bezier;
    })();

    function computePercentageFromEasing(percentage, easing) {
        return new Bezier(easing).solve(percentage);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVhc2luZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztRQUdBLFVBQUEsR0FDRSxTQURGLFVBQUEsQ0FDcUIsQ0FBUyxFQUFTLENBQVMsRUFBQTs4QkFEaEQsVUFBQTs7QUFDcUIsWUFBQSxDQUFBLENBQUMsR0FBRCxDQUFDLENBQVE7QUFBUyxZQUFBLENBQUEsQ0FBQyxHQUFELENBQUMsQ0FBUTtLQUFJOzs7QUFHN0MsUUFBTSxNQUFNLEdBQTJDLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUM7O0FBQ2pFLFFBQU0sSUFBSSxHQUE2QyxDQUFDLEdBQUcsRUFBQyxFQUFFLEVBQUMsR0FBRyxFQUFDLENBQUMsQ0FBQyxDQUFDOztBQUN0RSxRQUFNLE9BQU8sR0FBMEMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQzs7QUFDdkUsUUFBTSxRQUFRLEdBQXlDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7O0FBQ3ZFLFFBQU0sV0FBVyxHQUFzQyxDQUFDLElBQUksRUFBQyxDQUFDLEVBQUMsR0FBRyxFQUFDLENBQUMsQ0FBQyxDQUFDOztBQUU3RSxRQUFNLE9BQU8sR0FBRyxNQUFNLENBQUM7QUFFdkIsUUFBSSxZQUFZLEdBQUcsc0ZBQXNGLENBQUM7O0FBQzFHLGFBQUEscUJBQUEsQ0FBc0MsSUFBWSxFQUFBO0FBQ2hELFlBQUksWUFBOEMsQ0FBQztBQUNuRCxnQkFBUSxJQUFJLENBQUMsV0FBVyxFQUFFO0FBQ3hCLGlCQUFLLFFBQVE7QUFDWCw0QkFBWSxHQUFHLE1BQU0sQ0FBQztBQUN0QixzQkFBTTtBQUFBLEFBQ1IsaUJBQUssTUFBTTtBQUNULDRCQUFZLEdBQUcsSUFBSSxDQUFDO0FBQ3BCLHNCQUFNO0FBQUEsQUFDUixpQkFBSyxVQUFVO0FBQ2IsNEJBQVksR0FBRyxRQUFRLENBQUM7QUFDeEIsc0JBQU07QUFBQSxBQUNSLGlCQUFLLFNBQVM7QUFDWiw0QkFBWSxHQUFHLE9BQU8sQ0FBQztBQUN2QixzQkFBTTtBQUFBLEFBQ1IsaUJBQUssYUFBYTtBQUNoQiw0QkFBWSxHQUFHLFdBQVcsQ0FBQztBQUMzQixzQkFBTTtBQUFBLEFBQ1I7QUFDRSxvQkFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUN2QyxvQkFBSSxDQUFDLE9BQU8sRUFBRTtBQUNaLDBCQUFNLGdCQXJDTixhQUFhLENBcUNXLCtCQUErQixDQUFDLENBQUM7aUJBQzFEO0FBQ0QsNEJBQVksR0FBRyxDQUNiLE1BdkNBLE9BQU8sQ0F1Q0MsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQ25CLE1BeENBLE9BQU8sQ0F3Q0MsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQ25CLE1BekNBLE9BQU8sQ0F5Q0MsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQ25CLE1BMUNBLE9BQU8sQ0EwQ0MsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQ3BCLENBQUM7QUFDRixzQkFBTTtBQUFBLFNBQ1Q7QUFDRCxZQUFJLEtBQUssR0FBRyxJQUFJLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUNyQyxlQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ2hDOzs7OztRQUlELE1BQUE7QUFPRSxpQkFQRixNQUFBLENBT2MsSUFBc0QsRUFBQTtnQkFBckQsR0FBRyxHQUFKLElBQXNEO2dCQUFoRCxHQUFHLEdBQVQsSUFBc0Q7Z0JBQTNDLEdBQUcsR0FBZCxJQUFzRDtnQkFBdEMsR0FBRyxHQUFuQixJQUFzRDs7a0NBUHBFLE1BQUE7O0FBUUksZ0JBQUksQ0FBQyxHQUFHLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQztBQUNyQixnQkFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLElBQUksR0FBRyxHQUFHLEdBQUcsQ0FBQSxBQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQztBQUN4QyxnQkFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDO0FBRXJDLGdCQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLENBQUM7QUFDckIsZ0JBQUksQ0FBQyxHQUFHLEdBQUcsR0FBRyxJQUFJLEdBQUcsR0FBRyxHQUFHLENBQUEsQUFBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUM7QUFDeEMsZ0JBQUksQ0FBQyxHQUFHLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQztTQUN0Qzs7QUFmSCxjQUFBLFdBaUJFLENBQUMsR0FBQSxXQUFDLENBQVMsRUFBQTtBQUNULG1CQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFBLEdBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUEsR0FBSSxDQUFDLENBQUM7U0FDdkQ7O0FBbkJILGNBQUEsV0FxQkUsQ0FBQyxHQUFBLFdBQUMsQ0FBUyxFQUFBO0FBQ1QsbUJBQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUEsR0FBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQSxHQUFJLENBQUMsQ0FBQztTQUN2RDs7QUF2QkgsY0FBQSxXQXlCRSxNQUFNLEdBQUEsZ0JBQUMsQ0FBUyxFQUFBO0FBQ2QsbUJBQU8sQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFDLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUEsR0FBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQztTQUM3RDs7QUEzQkgsY0FBQSxXQTZCRSxNQUFNLEdBQUEsZ0JBQUMsQ0FBUyxFQUFBO0FBQ2QsbUJBQU8sQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFDLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUEsR0FBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQztTQUM3RDs7QUEvQkgsY0FBQSxXQWlDRSxZQUFZLEdBQUEsc0JBQUMsVUFBa0IsRUFBQTs7QUFFN0IsZ0JBQUksQ0FBQyxHQUFHLFVBQVUsQ0FBQztBQUNuQixnQkFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDOztBQUVULGlCQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQzFCLGlCQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFVLENBQUM7QUFDM0Isb0JBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxPQUFPLEVBQ3ZCLE9BQU8sQ0FBQyxDQUFDO0FBQ1gsaUJBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ25CLG9CQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsT0FBTyxFQUN2QixNQUFNO0FBQ1IsaUJBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUNmOztBQUdELGdCQUFJLEVBQUUsR0FBRyxHQUFHLENBQUM7QUFDYixnQkFBSSxFQUFFLEdBQUcsR0FBRyxDQUFDO0FBQ2IsZ0JBQUksQ0FBQyxHQUFHLFVBQVUsQ0FBQztBQUVuQixtQkFBTyxFQUFFLEdBQUcsRUFBRSxFQUFFO0FBQ2QsaUJBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2Qsb0JBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBVSxDQUFDLEdBQUcsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ2pELG9CQUFJLFVBQVUsR0FBRyxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQyxLQUFNLEVBQUUsR0FBRyxDQUFDLENBQUM7QUFDeEMsaUJBQUMsR0FBRyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUEsR0FBSSxFQUFFLEdBQUcsRUFBRSxDQUFDO2FBQ3pCO0FBQ0QsbUJBQU8sQ0FBQyxDQUFDO1NBQ1Y7O0FBNURILGNBQUEsV0E4REUsS0FBSyxHQUFBLGVBQUMsVUFBa0IsRUFBQTtBQUN0QixtQkFBTyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztTQUM5Qzs7ZUFoRUgsTUFBQTs7O0FBbUVBLGFBQUEsMkJBQUEsQ0FBNEMsVUFBa0IsRUFBRSxNQUF3QyxFQUFBO0FBQ3RHLGVBQU8sSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0tBQzdDIiwiZmlsZSI6ImVhc2luZy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QmFzZUV4Y2VwdGlvbn0gZnJvbSAnLi9leGNlcHRpb25zJztcbmltcG9ydCB7dG9GbG9hdH0gZnJvbSAnLi91dGlsJztcblxuZXhwb3J0IGNsYXNzIENvb3JkaW5hdGUge1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgeDogbnVtYmVyLCBwdWJsaWMgeTogbnVtYmVyKSB7fVxufVxuXG5leHBvcnQgY29uc3QgTElORUFSICAgICAgOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFswLDAsMSwxXTtcbmV4cG9ydCBjb25zdCBFQVNFICAgICAgICA6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWy4yNSwuMSwuMjUsMV07XG5leHBvcnQgY29uc3QgRUFTRV9JTiAgICAgOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFswLjQyLCAwLCAxLCAxXTtcbmV4cG9ydCBjb25zdCBFQVNFX09VVCAgICA6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWzAsIDAsIDAuNTgsIDFdO1xuZXhwb3J0IGNvbnN0IEVBU0VfSU5fT1VUIDogW251bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlcl0gPSBbMC40MiwwLC41OCwxXTtcblxuY29uc3QgRVBTSUxPTiA9IDEuMGUtNztcblxudmFyIEVBU0lOR19SRUdFWCA9IC9jdWJpYy1iZXppZXJcXChcXHMqKFstXFwuXFxkXSspXFxzKixcXHMqKFstXFwuXFxkXSspXFxzKixcXHMqKFstXFwuXFxkXSspXFxzKixcXHMqKFstXFwuXFxkXSspXFxzKlxcKS9pO1xuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVFYXNpbmdFcXVhdGlvbihuYW1lOiBzdHJpbmcpOiBGdW5jdGlvbiB7XG4gIHZhciBjb2VmZmljaWVudHM6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJdO1xuICBzd2l0Y2ggKG5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgIGNhc2UgJ2xpbmVhcic6XG4gICAgICBjb2VmZmljaWVudHMgPSBMSU5FQVI7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdlYXNlJzpcbiAgICAgIGNvZWZmaWNpZW50cyA9IEVBU0U7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdlYXNlLW91dCc6XG4gICAgICBjb2VmZmljaWVudHMgPSBFQVNFX09VVDtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2Vhc2UtaW4nOlxuICAgICAgY29lZmZpY2llbnRzID0gRUFTRV9JTjtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2Vhc2UtaW4tb3V0JzpcbiAgICAgIGNvZWZmaWNpZW50cyA9IEVBU0VfSU5fT1VUO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHZhciBtYXRjaGVzID0gbmFtZS5tYXRjaChFQVNJTkdfUkVHRVgpO1xuICAgICAgaWYgKCFtYXRjaGVzKSB7XG4gICAgICAgIHRocm93IG5ldyBCYXNlRXhjZXB0aW9uKCdJbnZhbGlkIGVhc2luZyB2YWx1ZSBwcm92aWRlZCcpO1xuICAgICAgfVxuICAgICAgY29lZmZpY2llbnRzID0gW1xuICAgICAgICB0b0Zsb2F0KG1hdGNoZXNbMV0pLFxuICAgICAgICB0b0Zsb2F0KG1hdGNoZXNbMl0pLFxuICAgICAgICB0b0Zsb2F0KG1hdGNoZXNbM10pLFxuICAgICAgICB0b0Zsb2F0KG1hdGNoZXNbNF0pXG4gICAgICBdO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgdmFyIGN1cnZlID0gbmV3IEJlemllcihjb2VmZmljaWVudHMpO1xuICByZXR1cm4gY3VydmUuc29sdmUuYmluZChjdXJ2ZSk7XG59XG5cbi8vIE1vc3RseSBpbnNwaXJlZCBieVxuLy8gaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9jb2Rlc2VhcmNoI2Nocm9taXVtL3NyYy91aS9nZngvZ2VvbWV0cnkvY3ViaWNfYmV6aWVyLmNjXG5jbGFzcyBCZXppZXIge1xuICBheF86IG51bWJlcjtcbiAgYnhfOiBudW1iZXI7XG4gIGN4XzogbnVtYmVyO1xuICBheV86IG51bWJlcjtcbiAgYnlfOiBudW1iZXI7XG4gIGN5XzogbnVtYmVyO1xuICBjb25zdHJ1Y3RvcihbcDF4LCBwMXksIHAyeCwgcDJ5XTogW251bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlcl0pIHtcbiAgICB0aGlzLmN4XyA9IDMuMCAqIHAxeDtcbiAgICB0aGlzLmJ4XyA9IDMuMCAqIChwMnggLSBwMXgpIC0gdGhpcy5jeF87XG4gICAgdGhpcy5heF8gPSAxLjAgLSB0aGlzLmN4XyAtIHRoaXMuYnhfO1xuXG4gICAgdGhpcy5jeV8gPSAzLjAgKiBwMXk7XG4gICAgdGhpcy5ieV8gPSAzLjAgKiAocDJ5IC0gcDF5KSAtIHRoaXMuY3lfO1xuICAgIHRoaXMuYXlfID0gMS4wIC0gdGhpcy5jeV8gLSB0aGlzLmJ5XztcbiAgfTtcblxuICB4KHQ6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuICgodGhpcy5heF8gKiB0ICsgdGhpcy5ieF8pICogdCArIHRoaXMuY3hfKSAqIHQ7XG4gIH1cblxuICB5KHQ6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuICgodGhpcy5heV8gKiB0ICsgdGhpcy5ieV8pICogdCArIHRoaXMuY3lfKSAqIHQ7XG4gIH1cblxuICB4cHJpbWUodDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gKDMuMCAqIHRoaXMuYXhfICogdCArIDIuMCAqIHRoaXMuYnhfKSAqIHQgKyB0aGlzLmN4XztcbiAgfVxuXG4gIHlwcmltZSh0OiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiAoMy4wICogdGhpcy5heV8gKiB0ICsgMi4wICogdGhpcy5ieV8pICogdCArIHRoaXMuY3lfO1xuICB9XG5cbiAgc29sdmVUZ2l2ZW5YKHBlcmNlbnRhZ2U6IG51bWJlcik6IG51bWJlciB7XG4gICAgLy8gYWRkIGFzc2VydCgwIDw9IHBlcmNlbnRhZ2UgJiYgcGVyY2VudGFnZSA8PSAxKTtcbiAgICB2YXIgdCA9IHBlcmNlbnRhZ2U7XG4gICAgdmFyIHgsIGQ7XG4gICAgLy8gRmlyc3QgdHJ5IGEgZmV3IGl0ZXJhdGlvbnMgb2YgTmV3dG9uJ3MgbWV0aG9kIC0tIG5vcm1hbGx5IHZlcnkgZmFzdC5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgICAgeCA9IHRoaXMueCh0KSAtIHBlcmNlbnRhZ2U7XG4gICAgICBpZiAoTWF0aC5hYnMoeCkgPCBFUFNJTE9OKVxuICAgICAgICByZXR1cm4gdDtcbiAgICAgIGQgPSB0aGlzLnhwcmltZSh0KTtcbiAgICAgIGlmIChNYXRoLmFicyhkKSA8IEVQU0lMT04pXG4gICAgICAgIGJyZWFrO1xuICAgICAgdCA9IHQgLSB4IC8gZDtcbiAgICB9XG5cbiAgICAvLyBGYWxsYmFjayB0byBiaXNlY3Rpb24uXG4gICAgdmFyIHQwID0gMC4wO1xuICAgIHZhciB0MSA9IDEuMDtcbiAgICB2YXIgdCA9IHBlcmNlbnRhZ2U7XG5cbiAgICB3aGlsZSAodDAgPCB0MSkge1xuICAgICAgeCA9IHRoaXMueCh0KTtcbiAgICAgIGlmIChNYXRoLmFicyh4IC0gcGVyY2VudGFnZSkgPCBFUFNJTE9OKSByZXR1cm4gdDtcbiAgICAgIGlmIChwZXJjZW50YWdlID4geCkgdDAgPSB0OyBlbHNlIHQxID0gdDtcbiAgICAgIHQgPSAodDEgLSB0MCkgKiAuNSArIHQwO1xuICAgIH1cbiAgICByZXR1cm4gdDtcbiAgfVxuXG4gIHNvbHZlKHBlcmNlbnRhZ2U6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMueSh0aGlzLnNvbHZlVGdpdmVuWChwZXJjZW50YWdlKSk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVQZXJjZW50YWdlRnJvbUVhc2luZyhwZXJjZW50YWdlOiBudW1iZXIsIGVhc2luZzogW251bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlcl0pIHtcbiAgcmV0dXJuIG5ldyBCZXppZXIoZWFzaW5nKS5zb2x2ZShwZXJjZW50YWdlKTtcbn1cbiJdfQ==